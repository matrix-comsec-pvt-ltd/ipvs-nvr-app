#ifndef PACKETCAPTURE_H_
#define PACKETCAPTURE_H_
//#################################################################################################
// FILE BRIEF
//#################################################################################################
/**
@file		MxPcap.h
@brief      This file facilitates capturing Network Packets.
*/
//#################################################################################################
// @INCLUDES
//#################################################################################################
/* Application Includes */
#include "ConfigComnDef.h"

//#################################################################################################
// @DEFINES
//#################################################################################################
#define MAX_FILTER_STR_SIZE	 60

//#################################################################################################
// @DATA TYPES
//#################################################################################################
typedef enum
{
    PCAP_STATUS_CAPTURING_PACKET,
    PCAP_STATUS_INVALID_FILTER,
    PCAP_STATUS_PROCESS_ERROR,
    PCAP_STATUS_MAX_SIZE_REACHED,
    PCAP_STATUS_SAFELY_CLOSED,
    PCAP_STATUS_PARSE_ERROR,
    PCAP_STATUS_INTERFACE_DOWN,
    PCAP_STATUS_MAX
}PCAP_STATUS_e;

typedef struct
{
    NETWORK_PORT_e  interface;
    CHAR            filterStr[MAX_FILTER_STR_SIZE];
}PCAP_START_t;

//#################################################################################################
// @PROTOTYPES
//#################################################################################################
//-------------------------------------------------------------------------------------------------
PCAP_STATUS_e PcapStart(PCAP_START_t *startParam);
//-------------------------------------------------------------------------------------------------
PCAP_STATUS_e PcapGetStatus(UINT16PTR capturedPacket, UINT32PTR bytesCaptured);
//-------------------------------------------------------------------------------------------------
void PcapStop(void);
//-------------------------------------------------------------------------------------------------
//#################################################################################################
// @END OF FILE
//#################################################################################################
#endif /* PACKETCAPTURE_H_ */
